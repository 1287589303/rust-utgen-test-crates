label_buffer containing ASCII and non-ASCII characters, current_label_start within 0 to 253, deny_list_deny_dot set to 0 or a mask allowing dots, fail_fast set to false, had_errors initialized to false; sizes of domain_buffer and label_buffer should test boundaries based on maximum lengths.
