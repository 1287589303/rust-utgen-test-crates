self.fragment_start must be a valid usize within the length of the serialization string, and the byte_at(f) must equal b'#' indicating a valid URL structure with fragment; position must be Position::BeforeFragment.
