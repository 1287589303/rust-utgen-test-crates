delegate writer must be a valid writable object, current_output_len must be between 0 and BUF_SIZE inclusive, and self.output must be a valid buffer with length BUF_SIZE.
