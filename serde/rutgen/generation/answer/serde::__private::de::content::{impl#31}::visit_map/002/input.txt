M must implement MapAccess<'de> and provide entries that either successfully return Ok(val) or fail with Err(err) when accessed; also should handle both valid and invalid scenarios to cover edge cases.
