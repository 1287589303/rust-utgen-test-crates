self must be an instance of Either with R matching the expected pattern, and buf should be a mutable reference to a non-empty byte slice (e.g., &mut [u8; 1..=1024]) to cover various sizes, including a boundary of zero-length and maximum expected length based on context.
