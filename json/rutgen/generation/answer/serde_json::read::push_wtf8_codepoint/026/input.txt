n in the range 0x80 to 0x7FF, inclusive; scratch is a mutable Vec<u8> with at least 4 bytes reserved.
