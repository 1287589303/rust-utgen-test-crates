first = true, writer is a mutable reference to any type implementing io::Write
