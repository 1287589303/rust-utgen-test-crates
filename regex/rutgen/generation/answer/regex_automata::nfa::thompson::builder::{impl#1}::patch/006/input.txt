self.states should contain at least one State::Fail entry, old_memory_states must equal memory_states before the patch operation, from and to must be valid StateID indices corresponding to existing states in the Builder.
