self.states should contain at least one State::Sparse; from and to must be valid StateID indices within the bounds of self.states; builder must have a valid memory state setup to trigger a panic.
