from: StateID representing a valid match state, to: StateID representing a valid transition state, memory_states <= size_limit, states contains at least one match state, old_memory_states equal to memory_states before the patch operation
