self.states must contain at least one State::Empty and one State::Union or State::UnionReverse to fulfill the memory state increase condition, from and to must be valid StateIDs corresponding to these states, and the check_size_limit must not exceed the size limit if set.
