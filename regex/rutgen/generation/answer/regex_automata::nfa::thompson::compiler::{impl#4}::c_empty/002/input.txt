self.add_empty() must return Ok with a valid StateID; ThompsonRef creation must handle valid StateID for start and end respectively.
