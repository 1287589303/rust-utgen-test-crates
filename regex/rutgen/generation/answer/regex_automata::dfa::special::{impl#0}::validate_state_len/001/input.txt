len: 1 to max.as_usize() >> stride2, stride2: 0 to max.as_usize().trailing_zeros(), max: len - 1
