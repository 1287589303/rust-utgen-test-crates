slice must be a non-empty byte array with at least 4 bytes aligned to 4-byte boundaries, state_len > 0, pair_len = 2 * state_len, slices_bytes_len = pair_len * 4, pattern_len > 0, idlen > 0, and check_slice_len must hold true for the pattern IDs slice, ensuring all calculated lengths are satisfied without overflow.
