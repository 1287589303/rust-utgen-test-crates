haystack should be a non-empty string; pikevm must be initialized with a valid pattern; at should be a valid index within the bounds of the haystack; slots must be initialized and contain size equal to haystack length; the last_match_end should be either None or a valid index within the haystack length.
