0 <= i < r.state_len() && cur_id != new_id && cur_id != id && oldmap has distinct entries for each state ID.
