self.state.uncompiled is empty; self.state.uncompiled has one element with last as None; self.state.uncompiled has multiple elements; self.target is a valid StateID; self.state.compiled returns a previously computed StateID for identical input; self.builder.add_sparse never returns an error; self.state.compiled returns None for new inputs.
