self.cur_byte is in the range [0, 255], self.end_byte is None or in the range [1, 256], and self.classes.get(byte) returns values such that self.last_class is initially not equal to class for byte values in self.cur_byte.
