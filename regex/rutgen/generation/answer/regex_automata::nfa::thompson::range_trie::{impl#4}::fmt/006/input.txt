self.states must be an empty vector Vec<State> and f must be a valid mutable reference to fmt::Formatter that allows for writing.
