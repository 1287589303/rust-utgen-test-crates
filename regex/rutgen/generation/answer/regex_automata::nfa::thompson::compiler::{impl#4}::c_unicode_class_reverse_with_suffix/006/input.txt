self.utf8_suffix.capacity > 0, cls must have UTF-8 ranges with valid start and end, brng.start < brng.end, end must be a valid StateID from the previous operations, cache must not be full, output must be a valid ThompsonRef structure
