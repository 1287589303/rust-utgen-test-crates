dst.len() == nwrite (where nwrite is calculated from self.write_to_len() with self.is_match == true, self.ntrans == 0, and self.pattern_ids.len() == 0)
