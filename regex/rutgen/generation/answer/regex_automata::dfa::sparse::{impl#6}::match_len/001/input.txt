StateID as input should range from 0 to state_len - 1 inclusive; ensure match_len returns a value greater than or equal to 0 and less than or equal to pattern_len.
