cache.visited should be in the state that allows insertion, sid should be a valid StateID corresponding to a ByteRange transition, input.haystack should have more elements than at, and trans should not match the byte at input.haystack[at] to expect a None return value.
