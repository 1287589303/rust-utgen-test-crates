cache.visited must be initialized successfully, sid must be a valid StateID corresponding to a Dense state, input.haystack must have a length greater than at, and dense.matches must return None for at within the valid range of input.haystack.
