self.states must not be empty, state must be valid, sid must be valid and greater than 0, self.start_anchored must be in range of states, self.start_pattern must have a length of at least 1, ensure internal state representation is valid and accessible, result must be either Ok or an expected error where f's buffer is full or otherwise invalid.
