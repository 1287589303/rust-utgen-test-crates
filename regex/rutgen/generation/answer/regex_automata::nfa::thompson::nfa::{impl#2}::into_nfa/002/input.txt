self.start_pattern must have at least one StateID; self.states must contain at least one State::Match; stack must have at least one StateID; seen should allow for insertion of StateID; and self should be properly initialized with valid memory allocation for states (ensuring Arc<Inner> can be created).
