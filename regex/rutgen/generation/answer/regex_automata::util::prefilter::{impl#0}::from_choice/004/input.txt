Choice is Choice::Memmem(Memmem) and max_needle_len is a value in the range of 0 to a reasonable upper limit, such as 1024, to ensure valid Prefilter creation.
