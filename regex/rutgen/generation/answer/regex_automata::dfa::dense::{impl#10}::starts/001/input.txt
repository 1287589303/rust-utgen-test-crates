self.st must be properly initialized with valid StartTable data, and its kind must be one of {both, unanchored, anchored}; pattern_len must be consistent with the length of initialized state IDs in self.st.table.
