builder.add_empty() must return Ok/Some, self.states must contain at least one state with a non-leaf transition that is reachable via t.next, f.sparse must have at least one element when the compile function is called, and the builder.add_sparse(sparse) call must fail for various sparse transition configurations with f.sparse containing up to one transition.
