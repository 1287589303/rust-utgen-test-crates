replacement: non-empty byte slice without '$', append function that appends valid values, name_to_index function mapping valid names to indices, dst as an empty byte vector
