i: usize should be within the range of 0 to (self.caps.len() - 1), potentially including boundary cases for 0 and self.caps.len()
