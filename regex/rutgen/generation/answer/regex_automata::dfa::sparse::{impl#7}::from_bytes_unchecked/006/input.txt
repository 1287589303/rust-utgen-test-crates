slice must have at least 256 bytes, state_len must be a valid usize, pattern_len must be a valid usize, classes must be a valid ByteClasses derived from a 256-byte slice, and len must be a valid usize less than or equal to the total length of slice minus the bytes consumed by state_len, pattern_len, and classes.
